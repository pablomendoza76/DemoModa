<div class="carrito-grid">
  <!-- 🧾 Lista de productos -->
  <div class="carrito-items" *ngIf="carrito.length > 0; else vacio">
    <h2 class="carrito-titulo">🛍️ Mi carrito ({{ carrito.length }})</h2>

    <div class="item-carrito" *ngFor="let item of carrito">
      <div class="item-imagen">
        <img [src]="item.imagen_url" [alt]="item.nombre" />
      </div>

      <div class="item-info">
        <div class="nombre-precio">
          <h3 class="nombre">{{ item.nombre }}</h3>
          <p class="precio">{{ item.precio | currency }}</p>
        </div>

        <div class="variantes">
          <span class="talla">Talla: {{ item.talla }}</span>
        </div>

        <div class="cantidad">
          <label for="cantidad-{{ item.id }}">Cantidad</label>
          <div class="cantidad-controles" id="cantidad-{{ item.id }}">
            <button (click)="restarCantidad(item)">−</button>
            <span class="cantidad-numero">{{ item.cantidad }}</span>
            <button (click)="sumarCantidad(item)">+</button>
          </div>
        </div>
      </div>

      <div class="item-eliminar">
        <button (click)="removerItem(item)">×</button>
      </div>
    </div>
  </div>

  <!-- 🛒 Carrito vacío -->
  <ng-template #vacio>
    <div class="carrito-vacio">
      <p>🛒 Tu carrito está vacío</p>
    </div>
  </ng-template>

  <!-- 🧍 Avatar renderizado justo debajo -->
<div class="contenedor-avatar">
  <app-avatar></app-avatar>
</div>


  <!-- 📦 Resumen: SIEMPRE visible -->
  <div class="resumen-pedido">
    <h3>Resumen</h3>

    <div class="linea">
      <span>Subtotal:</span>
      <span>{{ total | currency }}</span>
    </div>

    <div class="linea" *ngIf="descuento > 0">
      <span>Descuento:</span>
      <span>-{{ total * descuento | currency }}</span>
    </div>

    <div class="linea">
      <span>Envío:</span>
      <span>Gratis</span>
    </div>

    <div class="linea total">
      <span>Total:</span>
      <strong>{{ totalConDescuento | currency }}</strong>
    </div>

    <div class="cupon">
      <label for="cuponInput">¿Tienes un cupón?</label>
      <input
        id="cuponInput"
        type="text"
        placeholder="Ingresa tu código"
        [(ngModel)]="cuponIngresado"
      />
      <button class="btn aplicar" (click)="aplicarCupon()">Aplicar</button>
    </div>

    <button class="btn comprar" [disabled]="carrito.length === 0" (click)="abrirModalPedido()">
      🛒 Realizar pedido
    </button>
    <button class="btn vaciar" [disabled]="carrito.length === 0" (click)="vaciarCarrito()">
      🗑 Vaciar carrito
    </button>
    <button class="btn historial" (click)="abrirModalHistorialVentas()">
      📋 Ver mis compras anteriores
    </button>
    <button class="btn volver" (click)="volver()">← Volver a productos</button>
  </div>
</div>

