<!-- üß≠ Barra de categor√≠as -->
<nav class="barra-categorias">
  <div class="logo-navbar">
    <img src="/img/fondo1.png" alt="Logo" />
  </div>
  <ul class="lista-categorias">
    <li
      *ngFor="let categoria of categorias"
      class="categoria-item"
      (click)="seleccionarCategoria(categoria)"
    >
      {{ categoria.nombre }}
    </li>

    <!-- üìä Bot√≥n m√©tricas (solo para Sof√≠a) -->
    <li class="categoria-item" *ngIf="esSofia">
      <button
        class="btn-carrito-contenedor boton-invertido"
        (click)="irAMetricas()"
        title="Ver m√©tricas"
      >
        <span class="carrito-texto">Ver m√©tricas</span>
      </button>
    </li>

    <!-- üõí Bot√≥n de carrito -->
    <li class="categoria-item carrito-btn">
      <button
        class="btn-carrito-contenedor boton-invertido"
        (click)="irAVentas()"
        title="Ir a ventas"
      >
        <span class="carrito-texto">Carrito</span>
        <span class="carrito-icono">üõí</span>
      </button>
    </li>

    <!-- üîê Bot√≥n de sesi√≥n -->
    <li class="categoria-item">
      <button
        class="btn-carrito-contenedor boton-invertido"
        *ngIf="!usuarioAutenticado"
        (click)="iniciarSesion()"
        title="Iniciar sesi√≥n"
      >
        <span class="carrito-texto">Iniciar sesi√≥n</span>
      </button>

      <button
        class="btn-carrito-contenedor boton-invertido"
        *ngIf="usuarioAutenticado"
        (click)="cerrarSesion()"
        title="Cerrar sesi√≥n"
      >
        <span class="carrito-texto">Cerrar sesi√≥n</span>
      </button>
    </li>
  </ul>
</nav>

<div class="productos-container">
  <!-- üîç Barra de b√∫squeda fija -->
  <div class="barra-superior">
  <input
    type="text"
    [(ngModel)]="terminoBusqueda"
    (input)="aplicarFiltroBusqueda()"
    placeholder="Buscar producto..."
    class="input-busqueda"
  />

  <div class="acciones-derecha">
    <button
      class="btn-categorias"
      (click)="mostrarModalCategorias = !mostrarModalCategorias"
    >
      üîΩ Filtrar por categor√≠a
    </button>

    <button
      class="btn-crear-producto"
      *ngIf="esSofia"
      (click)="abrirModalCrearProducto()"
    >
      ‚ûï Crear producto
    </button>
  </div>
</div>


  <!-- üì¶ Modal lateral de categor√≠as -->
  <div class="modal-categorias" *ngIf="mostrarModalCategorias">
    <ul>
      <li
        *ngFor="let categoria of categorias"
        [class.activa]="categoriaActual?.id === categoria.id"
        (click)="seleccionarCategoria(categoria)"
      >
        {{ categoria.nombre }}
      </li>
    </ul>
  </div>

  <!-- üß© Tarjetas de productos -->
  <app-tarjeta-producto
    [productos]="productosFiltrados"
    [mostrarBotonEditar]="esSofia"
  ></app-tarjeta-producto>
</div>

<!-- üßæ Modal para crear producto -->
<div class="modal-crear-producto" *ngIf="mostrarModalCrearProducto">
  <div class="modal-contenido">
    <h2>Crear nuevo producto</h2>

    <form (ngSubmit)="guardarProducto()" #formProducto="ngForm">
      <div class="campo-formulario">
        <label for="nombre">Nombre *</label>
        <input
          type="text"
          id="nombre"
          [(ngModel)]="nuevoProducto.nombre"
          name="nombre"
          required
        />
      </div>

      <div class="campo-formulario">
        <label for="descripcion">Descripci√≥n</label>
        <textarea
          id="descripcion"
          [(ngModel)]="nuevoProducto.descripcion"
          name="descripcion"
        ></textarea>
      </div>

      <div class="campo-formulario">
        <label for="precio">Precio *</label>
        <input
          type="number"
          id="precio"
          [(ngModel)]="nuevoProducto.precio"
          name="precio"
          min="0"
          step="0.01"
          required
        />
      </div>

      <div class="campo-formulario">
        <label for="talla">Talla</label>
        <input
          type="text"
          id="talla"
          [(ngModel)]="nuevoProducto.talla"
          name="talla"
        />
      </div>

      <div class="campo-formulario">
        <label for="color">Color</label>
        <input
          type="text"
          id="color"
          [(ngModel)]="nuevoProducto.color"
          name="color"
        />
      </div>

      <div class="campo-formulario">
        <label for="tipo_genero">G√©nero *</label>
        <select
          id="tipo_genero"
          [(ngModel)]="nuevoProducto.tipo_genero"
          name="tipo_genero"
          required
        >
          <option [ngValue]="null">Seleccione un g√©nero</option>
          <option value="mujer">Mujer</option>
          <option value="hombre">Hombre</option>
          <option value="unisex">Unisex</option>
        </select>
      </div>

      <div class="campo-formulario">
        <label for="categoria_id">Categor√≠a</label>
        <select
          id="categoria_id"
          [(ngModel)]="nuevoProducto.categoria_id"
          name="categoria_id"
        >
          <option [ngValue]="null">Seleccione una categor√≠a</option>
          <option
            *ngFor="let cat of categorias"
            [ngValue]="cat.id"
            [disabled]="cat.id === 'todos'"
          >
            {{ cat.nombre }}
          </option>
        </select>
      </div>

      <div class="campo-formulario">
        <label for="imagen_url">URL de Imagen</label>
        <input
          type="text"
          id="imagen_url"
          [(ngModel)]="nuevoProducto.imagen_url"
          name="imagen_url"
        />
      </div>

      <div class="modal-acciones">
        <button type="button" (click)="cerrarModalCrearProducto()">Cancelar</button>
        <button type="submit" [disabled]="formProducto.invalid">Guardar</button>
      </div>
    </form>
  </div>
</div>

